> 原文：[Android inpreferredconfig参数分析](http://blog.csdn.net/ccpat/article/details/46834089)

### 参数说明

BitmapFactory.Options.inPreferredConfig的可选值有四个，分别为ALPHA_8，RGB_565，ARGB_4444，ARGB_8888。它们的含义列举如下:

|参数取值|含义|
|-|-|
|ALPHA_8|图片中每个像素用一个字节（8位）存储，该字节存储的是图片8位的透明度值|
|RGB_565|图片中每个像素用两个字节（16位）存储，两个字节中高5位表示红色通道，中间6位表示绿色通道，低5位表示蓝色通道|
|ARGB_4444|图片中每个像素用两个字节（16位）存储，Alpha，R，G，B四个通道每个通道用4位表示|
|ARGB_8888|图片中每个像素用四个字节（32位）存储，Alpha，R，G，B四个通道每个通道用8位表示|

**ALPHA_8模式**

ALPHA_8模式表示的图片信息中只包含Alpha透明度信息，不包含任何颜色信息，所以ALPHA_8模式只能用在一些特殊场景。

**RGB_565模式**

显然RGB_565模式不能表示所有的RGB颜色，它能表示的颜色数只有32 × 64 × 32 = 65536种，远远小于24位真彩色所能表示的颜色数（256 × 257 × 256 = 16677216）。当图片中某个像素的颜色不在RGB_565模式表示的颜色范围内时，会使用相近的颜色来表示。

**ARGB_4444模式**

ARGB_4444已被Android标记为@Deprecated，以下是Android Bitmap类中截取的关于ARGB_4444的注释，可以看到Android推荐使用ARGB_8888来代替ARGB_4444，原因是ARGB_4444表示出来的图片质量太差，而且在KITKAT（Android4.4）及其以上版本，使用ARGB_4444参数会直接在代码中被忽略，用ARGB_8888替代。所以ARGB_4444参数基本没有使用的必要了。 

**ARGB_8888模式**

ARGB_8888模式用8位来表示透明度，有256个透明度等级，用24位来表示R，G，B三个颜色通道，能够完全表示32位真彩色，但同时这种模式占用的内存空间也最大，是RGB_565模式的两倍，是ALPHA_8模式的4倍。

### 作用说明

~~*如果不需要透明度信息，就将其设置为RGB_565，可以减少一半的内存？*~~

如果inPreferredConfig不为null，解码器会尝试使用此参数指定的颜色模式来对图片进行解码，如果inPreferredConfig为null或者在解码时无法满足此参数指定的颜色模式，解码器会自动根据原始图片的特征以及当前设备的屏幕位深，选取合适的颜色模式来解码，例如，如果图片中包含透明度，那么对该图片解码时使用的配置就需要支持透明度，默认会使用ARGB_8888来解码。

也就是说inPreferredConfig指定的配置并非是一个强制选项，而是建议的（preferred）选项，Android在实际解码时会参考此参数的配置，但如果此配置不满足，Android会重新选取一个合适的配置来对图片进行解码。

**当出现不满足情况时，使用的合适配置是如何选取的？**

1. 如果inPreferredConfig为null，解码时使用的颜色模式会根据图片源文件的类型进行选取，如果图片文件的颜色模式为CMYK，或RGB565，则选取RGB_565。如果是其他类型，则选取ARGB_8888。

2. 如果inPreferredConfig指定的选项在解码时无法满足，并不会再根据图片文件的类型来选取合适的选项，而是直接使用ARGB_8888选项来解码。例如，图片源文件为RGB566编码的BMP图片，使用ALPHA_8选项来解码时属于不满足的情况，这时会选取ARGB_8888选项来解码，而不是选取RGB565。和inPreferredConfig为null时选取的“合适的”选项并不相同。

**什么情况下使用什么样的配置会出现不满足的情况？**

1. 所有情况下ARGB_8888配置都可以满足

2. 所有情况下ALPHA_8配置都不满足

3. 绝大多数情况下RGB565选项都不满足
